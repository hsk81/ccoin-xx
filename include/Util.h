/* 
 * File:   Util.h
 * Author: hsk81
 */

#ifndef UTIL_H
#define UTIL_H

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#include <glib.h>
#include <openssl/bn.h>

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#ifndef ARRAY_SIZE
#define ARRAY_SIZE(array) (sizeof(array) / sizeof((array)[0]))
#endif

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

namespace Util {
    void reverse_copy(guchar *target, const guchar *source, gsize size);

    void Hash(guchar *md256, gconstpointer data, gsize size);
    void Hash4(guchar *md32, gconstpointer data, gsize size);
    void Hash160(guchar *md160, gconstpointer data, gsize size);

    gint open_file(const gchar *name);
    gboolean read_file(
            const gchar *name, gpointer *data, gsize *size, gsize max_size);

    namespace BigNum {
        GString *getvch(const BIGNUM *value);
        void setvch(BIGNUM *value, gconstpointer data, gsize size);
    }

    namespace Djb2 {
        gulong hash(gulong hash, gconstpointer buffer, gsize length);
    }
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#endif /* UTIL_H */
