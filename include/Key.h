/* 
 * File:   Key.h
 * Author: hsk81
 */

#ifndef KEY_H
#define KEY_H

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#include <openssl/ec.h>
#include <glib.h>

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

struct TKey {
    EC_KEY *ec_key;
};

namespace Key {
    gboolean init(struct TKey *key);
    void free(struct TKey *key);
    gboolean generate(struct TKey *key);
    gboolean get_public(struct TKey *key, gpointer *pointer, gsize *size);
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

struct TKeyset {
    GHashTable *pubkey;
    GHashTable *pubkey_hash; //RIPEMD160
};

namespace Keyset {
    void init(struct TKeyset *keyset);
    void free(struct TKeyset *keyset);
    gboolean add(struct TKeyset *keyset, struct TKey *key);
    gboolean lookup(
            const struct TKeyset *keyset, gconstpointer pointer, gsize size,
            gboolean is_hash);
}

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#endif /* KEY_H */
